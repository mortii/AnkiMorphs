# Setup

## Linux

1. Set up local environment:
   You need to have python version 3.9 or higher.
    ``` bash
    python3 -m virtualenv venv
    source venv/bin/activate
    python3 -m pip install -r requirements.txt
    pre-commit install
    ```
2. Set the project python interpreter to be `MorphMan/venv/bin/python3.{xx}` to get your IDE to recognize the packages
   installed above.

3. Create a soft symbolic link from the cloned repo to the anki add-ons folder so anki finds morphman:
   ``` bash
   ln -s path/to/cloned/repo/MorphMan/morph  ~/.local/share/Anki2/addons21/morph
   ```
4. The bash shell script `.githooks/pre-commit` contains commands that check for errors in the project:
   ``` bash
   export PYTHONPATH=./  # necessary to run pylint on test-directory
   pylint tests morph -d W0611
   pytest
   ```

   pre-commit run --all-files or pre-commit run --a
5. if you use gitkraken you have to adjust the pre-commit script to activate the virtual environment first:
```bash
#!/usr/bin/env bash
# File generated by pre-commit: https://pre-commit.com
# ID: 138fd403232d2ddd5efb44317e38bf03

# start templated
ANKIMORPH_DIR=/home/neo/git/anki-morphs/
INSTALL_PYTHON=/home/neo/git/anki-morphs/venv/bin/python3
ARGS=(hook-impl --config=.pre-commit-config.yaml --hook-type=pre-commit)
# end templated

HERE="$(cd "$(dirname "$0")" && pwd)"
ARGS+=(--hook-dir "$HERE" -- "$@")

if [ -x "$INSTALL_PYTHON" ]; then
    cd $ANKIMORPH_DIR && source venv/bin/activate
    exec "$INSTALL_PYTHON" -mpre_commit "${ARGS[@]}"
elif command -v pre-commit > /dev/null; then
    exec pre-commit "${ARGS[@]}"
else
    echo '`pre-commit` not found.  Did you forget to activate your virtualenv?' 1>&2
    exit 1
fi
```
1. You can run these commands in a terminal manually if you want, or you can set the script up to run automatically before commits by running `scripts/setup_dev.sh`. Alternatively, you
   can create a run configuration in your IDE to execute the script, that way you can easily run it at your convenience.
